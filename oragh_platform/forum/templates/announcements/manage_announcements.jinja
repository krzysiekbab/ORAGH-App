{% extends "base.jinja" %}

{% block title %}ZarzƒÖdzaj og≈Çoszeniami - Forum{% endblock %}
{% block page_title %}ZarzƒÖdzaj og≈Çoszeniami{% endblock %}

{% block content %}

<div class="text-end align-items-center mb-4">
  <div class="button-container">
    <a href="{% url 'forum:create_announcement' %}" class="btn btn-success me-2">
      ‚ûï Nowe og≈Çoszenie
    </a>
    <a href="{% url 'forum:index' %}" class="btn btn-outline-secondary">
      ‚Üê Powr√≥t do forum
    </a>
  </div>
</div>

<!-- Display messages if any -->
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Zamknij"></button>
    </div>
  {% endfor %}
{% endif %}

<div class="card">
  <div class="card-body">
    {% if announcements %}
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-light">
            <tr>
              <th>Tytu≈Ç</th>
              <th class="text-center" style="width: 100px;">Status</th>
              <th class="text-center" style="width: 100px;">Priorytet</th>
              <th class="text-center" style="width: 150px;">Autor</th>
              <th class="text-center" style="width: 150px;">Data utworzenia</th>
              <th class="text-center" style="width: 120px;">Akcje</th>
            </tr>
          </thead>
          <tbody>
            {% for announcement in announcements %}
              <tr class="clickable-row" onclick="window.location='{% url 'forum:edit_announcement' announcement.id %}'">
                <td>
                  <h6 class="mb-1">{{ announcement.title }}</h6>
                  <p class="text-muted mb-0 small">{{ announcement.content|striptags|truncatechars:100 }}</p>
                </td>
                <td class="text-center">
                  {% if announcement.is_active %}
                    <span class="badge bg-success">Aktywne</span>
                  {% else %}
                    <span class="badge bg-secondary">Nieaktywne</span>
                  {% endif %}
                </td>
                <td class="text-center">
                  {% if announcement.priority > 0 %}
                    <span class="badge bg-warning text-dark">{{ announcement.priority }}</span>
                  {% else %}
                    <span class="badge bg-light text-dark">0</span>
                  {% endif %}
                </td>
                <td class="text-center">
                  <div class="small">
                    {{ announcement.author.first_name }} {{ announcement.author.last_name }}
                  </div>
                </td>
                <td class="text-center">
                  <div class="small">
                    {{ announcement.created_at|date:"d.m.Y" }}<br>
                    <span class="text-muted">{{ announcement.created_at|date:"H:i" }}</span>
                  </div>
                </td>
                <td class="text-center">
                  <div class="btn-group-vertical btn-group-sm" role="group">
                    <a href="{% url 'forum:edit_announcement' announcement.id %}" 
                       class="btn btn-outline-primary btn-sm"
                       title="Edytuj og≈Çoszenie"
                       onclick="event.stopPropagation();">
                      ‚úèÔ∏è
                    </a>
                    <a href="{% url 'forum:delete_announcement' announcement.id %}" 
                       class="btn btn-outline-danger btn-sm"
                       title="Usu≈Ñ og≈Çoszenie"
                       onclick="event.stopPropagation();">
                      üóëÔ∏è
                    </a>
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-center py-5">
        <i class="fas fa-bullhorn fa-3x text-muted mb-3"></i>
        <h5>Brak og≈Çosze≈Ñ</h5>
        <p class="text-muted mb-3">Nie ma jeszcze ≈ºadnych og≈Çosze≈Ñ w systemie.</p>
        <a href="{% url 'forum:create_announcement' %}" class="btn btn-success">
          ‚ûï Utw√≥rz pierwsze og≈Çoszenie
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
.table-hover tbody tr:hover {
  background-color: rgba(13, 110, 253, 0.04);
}

.clickable-row {
  cursor: pointer;
}

.clickable-row:hover {
  background-color: rgba(13, 110, 253, 0.08) !important;
}

.badge {
  font-size: 0.75em;
}

.btn-group-vertical {
  gap: 2px;
}

/* Button container responsive behavior */
@media (max-width: 768px) {
  .button-container {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .button-container .btn {
    width: 100%;
    margin: 0 !important; /* Remove me-2 margin on mobile */
  }
  
  .text-end {
    text-align: center !important;
  }
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .d-flex.justify-content-between {
    flex-direction: column;
    gap: 1rem;
    align-items: stretch;
  }
  
  .d-flex.justify-content-between > div {
    text-align: center;
  }
  
  .table-responsive {
    font-size: 0.9rem;
  }
  
  .btn {
    margin-bottom: 0.5rem;
  }
}

@media (max-width: 576px) {
  .table th, .table td {
    padding: 0.5rem;
  }
  
  h6 {
    font-size: 0.9rem;
  }
  
  .small {
    font-size: 0.8rem;
  }
}
</style>

{% endblock %}
